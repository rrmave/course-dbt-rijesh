How many users do we have?
select count(1)  from dbt_rijesh_r.stg_users;
130

On average, how many orders do we receive per hour?
select avg(order_count) from (select date_trunc('hour',created_at) as date_by_hour,count(order_id) as order_count from dbt_rijesh_r.stg_orders where created_at is not null group by date_trunc('hour',created_at)) as order_count_by_hour;
8.125

On average, how long does an order take from being placed to being delivered?
select avg(placed_delivered) from (select order_id,(delivered_at-created_at) placed_delivered from dbt_rijesh_r.stg_orders where created_at is not null and delivered_at is not null) as order_placed_delivered;
3 days

How many users have only made one purchase? Two purchases? Three+ purchases?
select count(user_id) from (select user_id,count(order_id) from dbt_rijesh_r.stg_orders group by user_id having count(order_id)=1) as users_1_purchases;
25
select count(user_id) from (select user_id,count(order_id) from dbt_rijesh_r.stg_orders group by user_id having count(order_id)=2) as users_2_purchases;
22
select count(user_id) from (select user_id,count(order_id) from dbt_rijesh_r.stg_orders group by user_id having count(order_id)>=3) as users_3_or_more_purchases;
81
